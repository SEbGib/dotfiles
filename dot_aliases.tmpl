# Aliases personnalisés - Générés par Chezmoi
# Hostname: {{ .chezmoi.hostname }}
# OS: {{ .chezmoi.os }}

# ===== NAVIGATION =====
alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias ~='cd ~'
alias -- -='cd -'  # Revenir au dossier précédent

# Navigation rapide vers dossiers importants
alias proj='cd ~/projects'
{{- if .work }}
alias work='cd ~/work'
alias company='cd ~/company'
{{- end }}
{{- if .personal }}
alias personal='cd ~/personal'
{{- end }}
alias config='cd ~/.config'
alias dotfiles='cd ~/.local/share/chezmoi'

# ===== LISTING AMÉLIORÉ =====
{{- if lookPath "eza" }}
# Eza (remplacement moderne de ls)
alias ls='eza --icons --group-directories-first'
alias ll='eza -la --icons --git --group-directories-first --time-style=long-iso'
alias la='eza -la --icons --group-directories-first'
alias lt='eza --tree --icons --level=3 --group-directories-first'
alias lta='eza --tree --icons --level=3 -a --group-directories-first'
alias l1='eza --tree --icons --level=1'
alias l2='eza --tree --icons --level=2'
alias recent='eza -la --icons --sort=modified --reverse'
alias size='eza -la --icons --sort=size --reverse'
{{- else }}
# Fallback ls classique avec couleurs
alias ls='ls --color=auto --group-directories-first'
alias ll='ls -la --color=auto --group-directories-first'
alias la='ls -la --color=auto'
alias lt='tree -L 3'
{{- end }}

# ===== OUTILS MODERNES =====
{{- if lookPath "bat" }}
alias cat='bat --style=auto'
alias catp='bat --style=plain'
alias catl='bat --style=numbers'
{{- end }}

{{- if lookPath "fd" }}
alias find='fd'
alias findi='fd -i'  # Case insensitive
{{- end }}

{{- if lookPath "rg" }}
alias grep='rg'
alias grepi='rg -i'  # Case insensitive
{{- end }}

{{- if lookPath "dust" }}
alias du='dust'
{{- end }}

{{- if lookPath "duf" }}
alias df='duf'
{{- end }}

{{- if lookPath "procs" }}
alias ps='procs'
{{- end }}

# ===== GIT AVANCÉ =====
alias g='git'
alias gst='git status'
alias gss='git status --short'
alias ga='git add'
alias gaa='git add --all'
alias gap='git add --patch'
alias gc='git commit'
alias gcm='git commit -m'
alias gca='git commit --amend'
alias gcan='git commit --amend --no-edit'
alias gco='git checkout'
alias gcb='git checkout -b'
alias gcd='git checkout develop'
alias gcm='git checkout main || git checkout master'
alias gp='git push'
alias gpu='git push -u origin HEAD'
alias gpf='git push --force-with-lease'
alias gpl='git pull'
alias gpr='git pull --rebase'
alias gf='git fetch'
alias gfa='git fetch --all --prune'
alias gd='git diff'
alias gds='git diff --staged'
alias gdh='git diff HEAD'
alias gl='git log --oneline --graph --decorate --all -20'
alias gll='git log --oneline --graph --decorate --all'
alias glp='git log --pretty=format:"%C(yellow)%h%Creset -%C(red)%d%Creset %s %C(green)(%cr) %C(blue)<%an>%Creset" --abbrev-commit'
alias gsh='git show'
alias gb='git branch'
alias gba='git branch -a'
alias gbd='git branch -d'
alias gbD='git branch -D'
alias gr='git remote'
alias grv='git remote -v'
alias grs='git reset'
alias grsh='git reset --hard'
alias grss='git reset --soft'
alias gst='git stash'
alias gstp='git stash pop'
alias gstl='git stash list'
alias gsts='git stash show'
alias gt='git tag'
alias gta='git tag -a'
alias gtd='git tag -d'
alias gm='git merge'
alias gmn='git merge --no-ff'
alias grb='git rebase'
alias grbi='git rebase -i'
alias grbc='git rebase --continue'
alias grba='git rebase --abort'
alias lg='lazygit'

# Git helpers
alias gclean='git branch --merged | grep -v "\\*\\|main\\|master\\|develop" | xargs -n 1 git branch -d'
alias gundo='git reset HEAD~1'
alias gwip='git add -A && git commit -m "WIP: work in progress"'
alias gunwip='git log -n 1 | grep -q -c "WIP" && git reset HEAD~1'
alias gignore='git update-index --assume-unchanged'
alias gunignore='git update-index --no-assume-unchanged'

# ===== TMUX =====
alias t='tmux'
alias ta='tmux attach'
alias tad='tmux attach -d'  # Detach others
# ts function is defined in .zshrc instead
alias tl='tmux list-sessions'
alias tk='tmux kill-session'
alias tka='tmux kill-server'  # Kill all
alias td='tmux detach'
alias tr='tmux source-file ~/.config/tmux/tmux.conf'  # Reload config

# ===== DÉVELOPPEMENT =====
# Éditeurs
alias v='nvim'
alias vim='nvim'
alias vi='nvim'
alias e='$EDITOR'
alias code.='code .'
alias subl.='subl .'

{{- if lookPath "php" }}
# PHP / Symfony
alias sf='symfony'
alias sfc='symfony console'
alias sfcc='symfony console cache:clear'
alias sfcw='symfony console cache:warmup'
alias sfr='symfony console router:match'
alias sfd='symfony console debug:router'
alias sfserve='symfony serve'
alias sfstop='symfony serve:stop'
alias sftest='symfony run bin/phpunit'
alias composer='composer'
alias ci='composer install'
alias cu='composer update'
alias cr='composer require'
alias crd='composer require --dev'
alias cs='composer show'
alias phpunit='vendor/bin/phpunit'
alias phpstan='vendor/bin/phpstan'
alias phpcs='vendor/bin/php-cs-fixer'
{{- end }}

{{- if lookPath "node" }}
# Node.js / NPM / Yarn
alias n='node'
alias nr='npm run'
alias ni='npm install'
alias nis='npm install --save'
alias nid='npm install --save-dev'
alias nig='npm install -g'
alias nu='npm uninstall'
alias nup='npm update'
alias nci='npm ci'
alias nls='npm list'
alias nlsg='npm list -g --depth=0'
alias nt='npm test'
alias nb='npm run build'
alias nd='npm run dev'
alias ns='npm start'
alias nw='npm run watch'
alias npx='npx'

# Yarn
alias y='yarn'
alias ya='yarn add'
alias yad='yarn add --dev'
alias yr='yarn remove'
alias yi='yarn install'
alias yu='yarn upgrade'
alias ys='yarn start'
alias yb='yarn build'
alias yt='yarn test'
alias yd='yarn dev'

# Package managers comparison
alias pnpm='pnpm'
alias pi='pnpm install'
alias pa='pnpm add'
alias pad='pnpm add -D'
alias pr='pnpm run'
{{- end }}

{{- if lookPath "docker" }}
# Docker
alias d='docker'
alias di='docker images'
alias dps='docker ps'
alias dpsa='docker ps -a'
alias dr='docker run'
alias drit='docker run -it'
alias drm='docker rm'
alias drmi='docker rmi'
alias de='docker exec'
alias deit='docker exec -it'
alias dl='docker logs'
alias dlf='docker logs -f'
alias db='docker build'
alias dp='docker pull'
alias dpu='docker push'
alias dn='docker network'
alias dv='docker volume'

# Docker Compose
alias dc='docker-compose'
alias dcu='docker-compose up'
alias dcud='docker-compose up -d'
alias dcd='docker-compose down'
alias dcb='docker-compose build'
alias dcl='docker-compose logs'
alias dclf='docker-compose logs -f'
alias dce='docker-compose exec'
alias dcr='docker-compose run'
alias dcs='docker-compose ps'
alias dcstop='docker-compose stop'
alias dcstart='docker-compose start'
alias dcrestart='docker-compose restart'
{{- end }}

# ===== SYSTÈME =====
alias h='history'
alias c='clear'
alias cls='clear'
alias q='exit'
alias reload='exec $SHELL'
alias path='echo -e ${PATH//:/\\n}'
alias now='date +"%T"'
alias nowdate='date +"%d-%m-%Y"'
alias week='date +%V'

# Processus
alias psg='ps aux | grep'
alias k9='kill -9'
alias ka='killall'

# Réseau
alias ports='netstat -tulanp'
alias listening='lsof -i -P -n | grep LISTEN'
alias myip='curl -s https://ipinfo.io/ip'
{{- if eq .chezmoi.os "darwin" }}
alias localip='ipconfig getifaddr en0'
alias flushdns='sudo dscacheutil -flushcache && sudo killall -HUP mDNSResponder'
{{- else }}
alias localip='hostname -I | cut -d" " -f1'
alias flushdns='sudo systemctl restart systemd-resolved'
{{- end }}

# ===== UTILITAIRES =====
# Archives
alias tgz='tar -czf'
alias untgz='tar -xzf'
alias zip='zip -r'

# Recherche
alias findname='find . -name'
alias findtype='find . -type'
alias largest='find . -type f -exec ls -s {} + | sort -n -r | head -20'

# Permissions
alias mx='chmod +x'
alias 000='chmod 000'
alias 644='chmod 644'
alias 755='chmod 755'
alias 777='chmod 777'

# ===== CONFIGURATION SPÉCIFIQUE OS =====
{{- if eq .chezmoi.os "darwin" }}
# macOS spécifique
alias finder='open -a Finder'
alias preview='open -a Preview'
alias chrome='open -a "Google Chrome"'
alias safari='open -a Safari'
alias brewup='brew update && brew upgrade && brew cleanup'
alias brewinfo='brew leaves | xargs brew desc --eval-all'
alias cask='brew install --cask'
alias showfiles='defaults write com.apple.finder AppleShowAllFiles -bool true && killall Finder'
alias hidefiles='defaults write com.apple.finder AppleShowAllFiles -bool false && killall Finder'
alias lock='/System/Library/CoreServices/Menu\ Extras/User.menu/Contents/Resources/CGSession -suspend'
alias emptytrash='sudo rm -rfv /Volumes/*/.Trashes; sudo rm -rfv ~/.Trash; sudo rm -rfv /private/var/log/asl/*.asl'
{{- else }}
# Linux spécifique
alias aptup='sudo apt update && sudo apt upgrade && sudo apt autoremove'
alias install='sudo apt install'
alias remove='sudo apt remove'
alias search='apt search'
alias info='apt show'
alias open='xdg-open'
alias pbcopy='xclip -selection clipboard'
alias pbpaste='xclip -selection clipboard -o'
{{- end }}

# ===== RACCOURCIS CONTEXTUELS =====
{{- if .work }}
# Entreprise
alias vpn='sudo openconnect --config=~/.openconnect/company.conf'
alias k='kubectl'
alias kctx='kubectx'
alias kns='kubens'
alias kgp='kubectl get pods'
alias kgs='kubectl get services'
alias kgd='kubectl get deployments'
alias kl='kubectl logs'
alias kd='kubectl describe'
alias ke='kubectl edit'
alias kdel='kubectl delete'
{{- end }}

{{- if .personal }}
# Personnel
alias blog='cd ~/projects/blog && code .'
alias server='ssh user@myserver.com'
# backup function is defined in .zshrc instead
{{- end }}

# ===== FONCTIONS COMME ALIASES =====
# Création rapide de dossier et navigation
# mkcd function is defined in .zshrc instead

# Backup rapide avec timestamp
alias bak='function _bak(){ cp "$1" "$1.backup.$(date +%Y%m%d_%H%M%S)"; }; _bak'

# Recherche et remplacement dans fichiers
alias replace='function _replace(){ rg -l "$1" | xargs sed -i "s/$1/$2/g"; }; _replace'

# Extraction universelle
alias extract='function _extract(){ 
    if [ -f "$1" ]; then
        case "$1" in
            *.tar.bz2)   tar xjf "$1"     ;;
            *.tar.gz)    tar xzf "$1"     ;;
            *.bz2)       bunzip2 "$1"     ;;
            *.rar)       unrar x "$1"     ;;
            *.gz)        gunzip "$1"      ;;
            *.tar)       tar xf "$1"      ;;
            *.tbz2)      tar xjf "$1"     ;;
            *.tgz)       tar xzf "$1"     ;;
            *.zip)       unzip "$1"       ;;
            *.Z)         uncompress "$1"  ;;
            *.7z)        7z x "$1"        ;;
            *)           echo "Format non supporté: $1" ;;
        esac
    else
        echo "Fichier non trouvé: $1"
    fi
}; _extract'

# ===== DIVERS =====
# Météo
alias weather='curl wttr.in/{{ if .personal }}Paris{{ else }}{{ .chezmoi.username }}{{ end }}'

# Speedtest
alias speedtest='curl -s https://raw.githubusercontent.com/sivel/speedtest-cli/master/speedtest.py | python3 -'

# Générateur de mots de passe
alias genpass='openssl rand -base64 32'

# QR Code pour partager texte
alias qr='function _qr(){ echo "$1" | qrencode -t UTF8; }; _qr'

# Aliases pour dotfiles avec Chezmoi
alias cz='chezmoi'
alias cza='chezmoi apply'
alias czd='chezmoi diff'
alias cze='chezmoi edit'
alias czs='chezmoi status'
alias czu='chezmoi update'
alias czcd='chezmoi cd'

# Tmux sessionizer
alias work-session='ts'  # Utilise la fonction ts() définie dans .zshrc

echo "✅ Aliases chargés ($(wc -l < ~/.aliases) lignes)"