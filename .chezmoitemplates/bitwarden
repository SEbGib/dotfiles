{{/* Template helper pour Bitwarden */}}
{{- define "bitwarden" -}}
{{- $item := . -}}
{{- if lookPath "bw" -}}
{{- $bwStatus := output "bw" "status" | fromJson -}}
{{- if eq $bwStatus.status "unlocked" -}}
{{- $bwItem := output "bw" "get" "item" $item | fromJson -}}
{{- $bwItem -}}
{{- else -}}
{{- fail "Bitwarden is locked. Please run: export BW_SESSION=\"$(bw unlock --raw)\"" -}}
{{- end -}}
{{- else -}}
{{- fail "Bitwarden CLI not found. Please install it first." -}}
{{- end -}}
{{- end -}}